#  Minecraft 伺服器管理器 - 使用指南 (User Guide)

歡迎使用 **Minecraft 伺服器管理器**！本指南將協助您快速上手，從建立第一個伺服器到進階的模組管理與系統監控。

##  目錄

1. [快速入門](#-快速入門)
2. [建立伺服器](#-建立伺服器)
3. [管理伺服器](#-管理伺服器)
4. [模組管理](#-模組管理)
5. [常見問題 (FAQ)](#-常見問題-faq)

---

##  快速入門

### 安裝程式
您有多種方式來安裝和使用此應用程式：

#### 可攜式版本（推薦新手）
- 從 [GitHub Releases](https://github.com/Colin955023/MinecraftServerManager/releases) 下載 `.zip` 檔案
- 解壓到任意位置
- 雙擊 `MinecraftServerManager.exe` 執行
- 無需安裝，可複製到 USB 隨身碟使用

#### 安裝版本（推薦日常使用）
- 從 [GitHub Releases](https://github.com/Colin955023/MinecraftServerManager/releases) 下載 `.exe` 安裝程式
- 執行安裝程式並按照指示操作
- 包含自動更新、系統整合等功能

#### 開發環境
開發環境建議使用 uv：先執行 `uv sync` 安裝依賴，再用 `uv run python -m src.main` 啟動。
也可以在已啟用虛擬環境的情況下執行 `python -m src.main`。

### 首次啟動
首次啟動時，程式會引導您選擇「伺服器主資料夾」的存放位置，程式會在該資料夾內自動建立 `servers` 子資料夾。

> **更新提示**：
- 安裝版本：啟動時會自動檢查更新並提示下載安裝程式。
- 可攜式版本：會提示可用的 `*-portable.zip` 更新並可選擇套用；若 Release 提供 checksum，程式會嘗試驗證下載檔案，驗證失敗時會中止更新。

若您在 UI 中遇到重啟或啟動問題，請將 UI 顯示的診斷字串貼上到 Issue，以便判斷是否為路徑或檔案權限問題。若工程師要求，才提供 `%TEMP%` 中的診斷檔案（例如 `latest_version.txt`、`download_status.txt`、`extract_status.txt`）。

### 資料儲存位置

**安裝版本**：
- 使用者設定：`%LOCALAPPDATA%\Programs\MinecraftServerManager\user_settings.json`
- 日誌檔案：`%LOCALAPPDATA%\Programs\MinecraftServerManager\log\`
  - 每次啟動程式會建立新的日誌檔案（格式：年-月-日-時-分.log）
  - 程式會自動清理舊日誌：當日誌資料夾超過 10MB 時會刪除舊日誌只保留 10 筆最新的

**可攜式版本**：
- 使用者設定：與程式同目錄下的 `.config/user_settings.json`
- 日誌檔案：與程式同目錄下的 `.log/` 資料夾

### 介面概覽
程式介面分為左側導航欄與右側功能區：
- **建立伺服器**：新增 Minecraft 伺服器實例。
- **管理伺服器**：啟動、停止與監控現有伺服器。
- **模組管理**：管理伺服器的模組 (Mods)。
- **匯入伺服器**：將現有的伺服器資料夾匯入管理。

---

##  建立伺服器

1. 點擊左側選單的 **「建立伺服器」**。
2. **伺服器名稱**：輸入一個易於識別的名稱（例如：Survival_1.20.4）。
3. **Minecraft 版本**：從下拉選單中選擇遊戲版本。程式會自動獲取最新列表。
4. **載入器類型**：
   - **Vanilla**：原版伺服器，無模組支援。
   - **Fabric**：輕量級模組載入器，效能優異。
   - **Forge**：功能強大的模組載入器，相容性廣。
5. **載入器版本**：選擇對應的載入器版本（通常建議選擇最新穩定版）。
6. **記憶體設定**：
   - **最小記憶體**：建議至少 1024 MB。
   - **最大記憶體**：根據您的電腦配備設定。
     - 小型伺服器 (1-5人)：2048 MB (2GB)
     - 中型伺服器 (5-10人)：4096 MB (4GB)
     - 大型伺服器 (10人+)：8192 MB (8GB+)
7. 點擊 **「建立伺服器」** 按鈕。程式將自動下載所需的伺服器核心與 Java 環境。

---

##  管理伺服器

在 **「管理伺服器」** 頁面，您可以對已建立的伺服器進行操作：

### 基本操作
- **啟動**：啟動選定的伺服器。
- **停止**：安全關閉伺服器（發送 stop 指令）。
- **強制停止**：若伺服器無回應，可強制終止程序。

### 監控視窗
點擊 **「監控」** 按鈕可開啟獨立的監控視窗：
- **資源監控**：即時圖表顯示 CPU 與記憶體使用率。
- **控制台**：查看伺服器日誌輸出。
- **複製玩家名稱**：滑鼠於玩家列表點選玩家名稱即可複製到剪貼簿方便指令操作
- **指令輸入**：在下方輸入框輸入指令（如 /op player、/gamemode creative）並按下 Enter 發送。

### 屬性設定
點擊 **「屬性」** 按鈕可開啟 server.properties 編輯器，圖形化調整伺服器設定（如遊戲難度、PVP 開關、最大玩家數等）。

### 偵測或匯入既有伺服器
1. 在您選定的伺服器存放位置進行掃描。
2. 按 **「🔍 偵測現有伺服器」** 掃描路徑下的資料夾並自動判斷載入器、Minecraft 版本與啟動腳本。
3. 也可按 **「➕ 手動新增」**，跳轉道建立伺服器頁面建立新的伺服器。
4. 若要匯入現有伺服器，點擊左側選項「匯入伺服器」支援匯入資料夾或壓縮檔
5. 若偵測結果需要更新，選取伺服器並在右鍵選單使用 **「重新檢測伺服器」**。

### 備份與還原
- 選擇要備份的伺服器，於底部選項選擇**備份地圖檔**即可選擇位置並進行地圖檔備份
- 於右鍵選單點選 **「📁 重新設定備份路徑」** 可為該伺服器指定備份資料夾（預設以 `<server_name>_backup` 建立）。
- 點選 **「📂 開啟備份資料夾」** 快速開啟備份目錄，將整個伺服器資料夾複製到安全位置即可完成備份。

---

##  模組管理

本功能參考了 PrismLauncher 的設計，讓模組管理變得直觀且高效。

1. 點擊左側選單的 **「模組管理」**。
2. 從上方下拉選單選擇要管理的伺服器。
3. **模組列表**：
   - 顯示 mods 資料夾內的所有 .jar 檔案。
   - **啟用狀態**：顯示為 .jar。
   - **停用狀態**：顯示為 .jar.disabled。
4. **操作方式**：
   - **單一操作**：雙擊模組名稱即可切換啟用/停用狀態。
   - **批量操作**：按住 Ctrl 或 Shift 選擇多個模組，然後點擊下方的 **「啟用」** 或 **「停用」** 按鈕。
   - **重新整理**：若您手動在資料夾中新增了模組，點擊 **「重新整理」** 更新列表。

---

##  常見問題 (FAQ)

### Q: 需要手動安裝 Java 嗎？
**A: 不需要。** 程式會自動偵測系統中的 Java 版本。若缺少合適版本（例如 Minecraft 1.18+ 需要 Java 17），程式會自動從 Microsoft 下載並設定，完全不影響您系統原有的 Java 環境。

### Q: 為什麼模組列表中沒有顯示我的模組？
**A:** 請確認：
1. 模組檔案已放入伺服器的 mods 資料夾中。
2. 檔案副檔名必須為 .jar 或 .jar.disabled。
3. 點擊 **「重新整理」** 按鈕更新列表。

### Q: 如何新增模組？
**A:** 目前僅支援**匯入模組**或**匯出模組清單**，線上新增模組目前暫停製作，敬請期待日後版本更新。

### Q: 如何備份伺服器？
**A:** 在 **「管理伺服器」** 頁面，點擊 **「備份地圖檔」**，選擇安全的位置即可自動建立批次檔進行備份。

### Q: 伺服器啟動失敗怎麼辦？
**A:** 請開啟 **「監控」** 視窗查看錯誤日誌。常見原因包括：
- 記憶體設定過大（超過系統可用記憶體）。
- 模組版本不相容或缺少依賴模組。
- Java 版本不符（程式通常會自動處理，但若手動修改過設定可能導致此問題）。

---

**需要更多協助？**
請開啟 **「監控」** 視窗查看錯誤日誌輸出，或在 GitHub 專案頁面提交 Issue。
